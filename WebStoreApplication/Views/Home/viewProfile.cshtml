
@using Newtonsoft.Json;
@using WebStoreApplication.Global;
@using WebStoreApplication.Shared;

@{
    ViewData["Title"] = "viewProfile";

    int userId = Session.userId;
    String path = "http://localhost:5000/products/all/user/" + userId;
    String result = Global.Get(path);
    List<ProductModel> products = JsonConvert.DeserializeObject<List<ProductModel>>(result);
}


<form>
    <div class="container">
        <h1>My Profile</h1>
        <p>Please fill in this form to create an account.</p>

        <p>Already have an account? <a asp-area="" asp-controller="Home" asp-action="Login">Sign in</a>.</p>

    </div>
    <hr>
    <h2>Personal Details</h2>
    <div class="form-group row">
        <label for="colFormLabel" class="col-sm-2 col-form-label">Username</label>
        <div class="col-sm-10">
            <input type="email" class="form-control" id="colFormLabel" placeholder="Username" readonly>
        </div>
    </div>
    <div class="form-group row">
        <label for="colFormLabel" class="col-sm-2 col-form-label">First Name</label>
        <div class="col-sm-10">
            <input type="email" class="form-control" id="colFormLabel" placeholder="First Name" readonly>
        </div>
    </div>
    <div class="form-group row">
        <label for="colFormLabel" class="col-sm-2 col-form-label">Surname</label>
        <div class="col-sm-10">
            <input type="email" class="form-control" id="colFormLabel" placeholder="Surname" readonly>
        </div>
    </div>
    <div class="form-group row">
        <label for="colFormLabel" class="col-sm-2 col-form-label">Email Address</label>
        <div class="col-sm-10">
            <input type="email" class="form-control" id="colFormLabel" placeholder="Email Address" readonly>
        </div>
    </div>
    <div class="form-group row">
        <label for="colFormLabel" class="col-sm-2 col-form-label">Contacnt Number</label>
        <div class="col-sm-10">
            <input type="email" class="form-control" id="colFormLabel" placeholder="Contacnt Number" readonly>
        </div>
    </div>

    <hr />

    <div id="googleMap" style="width:100%;height:400px;"></div>

    <hr />

    <h2>Adress Details</h2>
    <div class="form-group row">
        <label for="colFormLabel" class="col-sm-2 col-form-label">Street Number</label>
        <div class="col-sm-10">
            <input type="email" class="form-control" id="colFormLabel" placeholder="Street Number" readonly>
        </div>
    </div>
    <div class="form-group row">
        <label for="colFormLabel" class="col-sm-2 col-form-label">Street Name</label>
        <div class="col-sm-10">
            <input type="email" class="form-control" id="colFormLabel" placeholder="Street Name" readonly>
        </div>
    </div>
    <div class="form-group row">
        <label for="colFormLabel" class="col-sm-2 col-form-label">Complex Name</label>
        <div class="col-sm-10">
            <input type="email" class="form-control" id="colFormLabel" placeholder="Complex Name" readonly>
        </div>
    </div>
    <div class="form-group row">
        <label for="colFormLabel" class="col-sm-2 col-form-label">Unit Number</label>
        <div class="col-sm-10">
            <input type="email" class="form-control" id="colFormLabel" placeholder="Unit Number" readonly>
        </div>
    </div>
    <div class="form-group row">
        <label for="colFormLabel" class="col-sm-2 col-form-label">Suburb</label>
        <div class="col-sm-10">
            <input type="email" class="form-control" id="colFormLabel" placeholder="Suburb" readonly>
        </div>
    </div>
    <div class="form-group row">
        <label for="colFormLabel" class="col-sm-2 col-form-label">City</label>
        <div class="col-sm-10">
            <input type="email" class="form-control" id="colFormLabel" placeholder="City">
        </div>
    </div>

    <button type="button" class="btn btn-secondary btn-lg btn-block">Update</button>
    <button type="button" class="btn btn-danger btn-lg btn-block" onclick="@("window.location.href='" + @Url.Action("Index", "Home") + "'");">Cancel</button>

</form>

<br />
<br />

<h1>Products</h1>

<table class="table" id="productsTable">
    <thead>
        <tr>
            <th scope="col">Product Name</th>
            <th scope="col">Description</th>
            <th scope="col">Category</th>
            <th scope="col">Price</th>
            <th scope="col"></th>
        </tr>
    </thead>
    <tbody>
        @{
            foreach (ProductModel product in products)
            {
                <tr>
                    <td>@product.productName</td>
                    <td>@product.productDescription</td>
                    <td>@product.typeModel.typeName</td>
                    <td>R @product.price</td>
                    <td><a href="https://localhost:5001/Home/ProductDetails" onclick="storeProductClicked(@product.productID)">View</a></td>
                </tr>
            }
        }
    </tbody>
</table>

<script>
    function myMap() {
        var mapProp = {
            center: new google.maps.LatLng(51.508742, -0.120850),
            zoom: 5,
        };
        var map = new google.maps.Map(document.getElementById("googleMap"), mapProp);
    }
</script>

<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBMgp8KNu--8z1l3FwX8A_veESiSxPmyIo&callback=initMap"></script>


@section Scripts{
    <script>
        $(document).ready(function () {
            $('#productsTable').DataTable({
                "aaSorting": [],
                columnDefs: [{
                    orderable: false,
                    targets: 3
                }]
            });
            $('.dataTables_length').addClass('bs-select');
        });

        function storeProductClicked(productId) {
            localStorage.setItem("productSelected", productId);
        }
    </script>
}